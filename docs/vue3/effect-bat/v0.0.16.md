---
title: v0.0.16
---

/\*\*

- 为了能让嵌套的 effect 正常执行，我们需要使用到数据结构栈，
- 栈是一种先入后出的数据结构，是一个操作受限的线性列表。
- 若想了解更多与数据结构相关的技术，可以查看 datastructure 边写边学系列。
-
- 现在，我们先增加一个数组，用于保存副作用函数的栈来使用，
- 接着，重构 effect 函数，先将 activeEffect 压入栈，然后将当前副作用函数
- 赋值给 activeEffect，fn 函数执行完之后，调用数组的 pop 方法，将栈顶弹出
- 并赋值给 activeEffect。具体实现可查看下方代码。
-
- 这样无论 effect 调用嵌套多少层，通过栈这个数据结构，我们都能给 activeEffect
- 设置为正确的值。
-
- 不过，运行之后，发现了一个很明显的问题，那就是当修改 objInner 的 text 值时，
- 对应的 effectFnInner 执行了两次！这是为什么呢？
  \*/
