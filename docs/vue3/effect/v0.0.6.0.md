---
title: v0.0.6.0
---

通常，当我们遇到问题时，若能一下子就想到可行的解决办法，那是极好的！若是无法想到，那就得多思考多尝试。就好比我们现在碰到的问题，由于全局变量 `activeEffect` 只会指向最新的副作用函数，根据我们目前的实现来看，依托 `activeEffect` 全局变量的方式去执行用户对应的副作用函数，很明显是无法做到的。

经过深入思考之后，我们发现，我们现在需要设计一种响应数据跟副作用函数之间的映射关系，通过响应数据就能找到对应的副作用函数，当触发响应数据的 `set` 拦截器时，就能找到关联的到副作用函数并执行。照这个思路的话，我们就需要解决以下问题：

1. 映射关系的数据结构应该如何设计？
2. 映射关系在什么时候注册？

我们可以先设计一种比较简单的数据结构，比如让数据跟副作用函数形成一对一的结构，如下所示：

<Link :nodes="list"></Link>

这种以目标对象 `target` 为键，`effectFn` 为值的键值对，`Object` 是无法存储的，我们就需要引入 `Map` 数据结构。`Map` 是啥呢？下节会简单介绍一下，同时我们可以想一想映射关系在什么时候注册比较合适这个问题。

<script setup>
  const list = [{ text:'target' }, { text:'effectFn' }]
</script>
